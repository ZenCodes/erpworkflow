
<link rel="import" href="..\..\bower_components/polymer/polymer.html">
<link rel="import" href="..\..\bower_components/paper-input/paper-input.html">
<link rel="import" href="..\..\bower_components/paper-button/paper-button.html">
<link rel="import" href="..\..\bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="..\..\bower_components/paper-item/paper-item.html">
<link rel="import" href="..\..\bower_components/paper-item/paper-item.html">
<link rel="import" href="../user-service/user-service.html">
<dom-module id="resetpassword-card">
  <template>
    <style>
 .card{
  position: relative;
  background-color: rgb(255, 255, 255);
  color: black;
  border-radius: 2px;
  box-shadow: rgba(0, 0, 0, 0.0980392) 5px 5px 4px, rgba(0, 0, 0, 0.0980392) 0px 0px 10px;
  width: 23%;
  height: 100%;
  left: 10%;
  margin-top: 10%;
  margin-left: 27%;
  text-align: center;
  }
  paper-button{
  text-transform: none;
  text-align: center;
  border-radius: 2px;
  box-shadow: rgba(0, 0, 0, 0.0980392) 5px 5px 4px, rgba(0, 0, 0, 0.0980392) 0px 0px 10px;
  background-color: #3d6868;
  color: white;
  }
  paper-input{
  margin-left: 20%;  
  width: 60%;
  }
  paper-icon-button{
  margin-left: -80%;
  }
    </style>
     <div class="card">
      <paper-icon-button noink icon="arrow-back" on-click="FnBack"></paper-icon-button>
      <center><h2>Reset Password</h2></center> 
      <paper-input label="Enter UserName" value="{{empid}}" on-change="FnChange"></paper-input>      
      <paper-input type="password" label="Enter New Password" value="{{newpass}}"></paper-input>
      <paper-input label="Enter Code" value="{{code}}" hidden$="{{hidecode}}"></paper-input>
      <div class="button">
      <paper-button on-click="FnResetPassword">Reset</paper-button>
      <paper-item></paper-item>
     </div>
     </div>
     <user-service id="userservice"></user-service>
  </template>
  <script>
  (function() {
    'use strict';

    Polymer({
      is: 'resetpassword-card',

      properties: {
        foo: {
          type: String,
          value: 'resetpassword-card',
          notify: true
        }
      },
      ready:function(){
        this.hidecode=true;
        this.text="";
      },
      FnChange:function(){
        this.hidecode=false;
        this.createid();
      },
      createid:function()
      {    
      var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
      for( var i=0; i < 6; i++ ){
        this.text += possible.charAt(Math.floor(Math.random() * possible.length)); 
      }
        alert("Please enter the verification code,Which sent to your mail!");
        this.$.userservice.callMailService(this.empid,this.text);    
      },
      FnResetPassword:function(){
        // alert(this.text+" "+this.code)
        if(this.text==this.code){
        // alert("hi");
        this.$.userservice.callResetpasswordservice(this.empid,this.newpass);
        }
        else{
        alert("Invalid code!");
        this.code="";
        }
      },      
      FnBack:function(){
        document.querySelector('app-card').setPage('login-card');
      }
    });
  })();
  </script>
</dom-module>
